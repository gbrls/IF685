
CONSULTA COM GROUP BY

SELECT SUPERVISOR, COUNT(*)
FROM MEDICO
WHERE SUPERVISOR IS NOT NULL
GROUP BY SUPERVISOR;


--INNER JOIN COM GROUP BY
--mostra o nome do supervisor e a quantidade de supervisionados desde que ele supervisione mais de 2 medicos. 

SELECT M1.NOME AS SUPERVISOR, COUNT(M1.NOME) AS QTD_SUPERVISIONADO
FROM MEDICO M1 INNER JOIN
MEDICO M2 ON M2.SUPERVISOR = M1.CPF
GROUP BY M1.NOME
HAVING  COUNT(M1.NOME) > 2;

SELECT NOME
FROM PACIENTE
WHERE CPF NOT IN (SELECT CPF_PACIENTE
FROM ULTILIZA));

SELECT NOME
FROM PACIENTE
WHERE CPF IN (SELECT CPF
FROM ARTE);

SELECT NOME FROM PACIENTE
UNION
SELECT NOME FROM MEDICO;

